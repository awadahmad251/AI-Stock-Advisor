import { createContext, useContext, useState, useEffect } from 'react';

const translations = {
  en: {
    appName: 'AI Stock Advisor',
    subtitle: 'S&P 500 Intelligence \u2022 Powered by LLaMA',
    chat: 'Chat',
    portfolio: 'Portfolio',
    screener: 'Screener',
    heatmap: 'Heatmap',
    backtest: 'Backtest',
    compare: 'Compare',
    watchlist: 'Watchlist',
    earnings: 'Earnings',
    news: 'News',
    liveData: 'Live Data',
    model: 'Model',
    askPlaceholder: 'Ask about stocks, market trends, or investment strategies...',
    disclaimer: 'AI Stock Advisor uses S&P 500 data & news. Not financial advice \u2014 consult a professional before investing.',
    totalValue: 'Total Value',
    totalPnL: 'Total P&L',
    holdings: 'Holdings',
    addHolding: 'Add Holding',
    symbol: 'Symbol',
    shares: 'Shares',
    buyPrice: 'Buy Price',
    buyDate: 'Buy Date',
    add: 'Add',
    remove: 'Remove',
    search: 'Search',
    filter: 'Filter',
    sector: 'Sector',
    allSectors: 'All Sectors',
    generateReport: 'Generate Report',
    downloadPDF: 'Download PDF',
    investment: 'Investment',
    period: 'Period',
    run: 'Run',
    clear: 'Clear',
    marketOverview: 'Market Overview',
    latestNews: 'Latest Market News',
    analyzingData: 'Analyzing market data...',
    sentimentAnalysis: 'Sentiment Analysis',
    bullish: 'Bullish',
    bearish: 'Bearish',
    neutral: 'Neutral',
    enterTicker: 'Enter ticker (e.g. AAPL)',
    settings: 'Settings',
    language: 'Language',
    theme: 'Theme',
  },
  es: {
    appName: 'Asesor de Acciones IA',
    subtitle: 'Inteligencia S&P 500 \u2022 Impulsado por LLaMA',
    chat: 'Chat',
    portfolio: 'Portafolio',
    screener: 'Filtro',
    heatmap: 'Mapa de Calor',
    backtest: 'Simulaci\u00f3n',
    compare: 'Comparar',
    watchlist: 'Seguimiento',
    earnings: 'Ganancias',
    news: 'Noticias',
    liveData: 'Datos en Vivo',
    model: 'Modelo',
    askPlaceholder: 'Pregunta sobre acciones, tendencias del mercado o estrategias de inversi\u00f3n...',
    disclaimer: 'Asesor de Acciones IA usa datos del S&P 500. No es asesor\u00eda financiera.',
    totalValue: 'Valor Total',
    totalPnL: 'P&L Total',
    holdings: 'Posiciones',
    addHolding: 'Agregar Posici\u00f3n',
    symbol: 'S\u00edmbolo',
    shares: 'Acciones',
    buyPrice: 'Precio de Compra',
    buyDate: 'Fecha de Compra',
    add: 'Agregar',
    remove: 'Eliminar',
    search: 'Buscar',
    filter: 'Filtrar',
    sector: 'Sector',
    allSectors: 'Todos los Sectores',
    generateReport: 'Generar Reporte',
    downloadPDF: 'Descargar PDF',
    investment: 'Inversi\u00f3n',
    period: 'Per\u00edodo',
    run: 'Ejecutar',
    clear: 'Limpiar',
    marketOverview: 'Resumen del Mercado',
    latestNews: '\u00daltimas Noticias del Mercado',
    analyzingData: 'Analizando datos del mercado...',
    sentimentAnalysis: 'An\u00e1lisis de Sentimiento',
    bullish: 'Alcista',
    bearish: 'Bajista',
    neutral: 'Neutral',
    enterTicker: 'Ingrese ticker (ej. AAPL)',
    settings: 'Configuraci\u00f3n',
    language: 'Idioma',
    theme: 'Tema',
  },
  zh: {
    appName: 'AI\u80a1\u7968\u987e\u95ee',
    subtitle: 'S&P 500 \u667a\u80fd\u5206\u6790 \u2022 LLaMA \u9a71\u52a8',
    chat: '\u5bf9\u8bdd',
    portfolio: '\u6295\u8d44\u7ec4\u5408',
    screener: '\u7b5b\u9009\u5668',
    heatmap: '\u70ed\u529b\u56fe',
    backtest: '\u56de\u6d4b',
    compare: '\u5bf9\u6bd4',
    watchlist: '\u81ea\u9009\u80a1',
    earnings: '\u8d22\u62a5',
    news: '\u65b0\u95fb',
    liveData: '\u5b9e\u65f6\u6570\u636e',
    model: '\u6a21\u578b',
    askPlaceholder: '\u8be2\u95ee\u80a1\u7968\u3001\u5e02\u573a\u8d8b\u52bf\u6216\u6295\u8d44\u7b56\u7565...',
    disclaimer: 'AI\u80a1\u7968\u987e\u95ee\u4f7f\u7528S&P 500\u6570\u636e\u3002\u8fd9\u4e0d\u662f\u8d22\u52a1\u5efa\u8bae\u3002',
    totalValue: '\u603b\u4ef7\u503c',
    totalPnL: '\u603b\u76c8\u4e8f',
    holdings: '\u6301\u4ed3',
    addHolding: '\u6dfb\u52a0\u6301\u4ed3',
    symbol: '\u4ee3\u7801',
    shares: '\u80a1\u6570',
    buyPrice: '\u4e70\u5165\u4ef7',
    buyDate: '\u4e70\u5165\u65e5\u671f',
    add: '\u6dfb\u52a0',
    remove: '\u5220\u9664',
    search: '\u641c\u7d22',
    filter: '\u7b5b\u9009',
    sector: '\u884c\u4e1a',
    allSectors: '\u6240\u6709\u884c\u4e1a',
    generateReport: '\u751f\u6210\u62a5\u544a',
    downloadPDF: '\u4e0b\u8f7dPDF',
    investment: '\u6295\u8d44\u989d',
    period: '\u65f6\u95f4\u6bb5',
    run: '\u8fd0\u884c',
    clear: '\u6e05\u9664',
    marketOverview: '\u5e02\u573a\u6982\u89c8',
    latestNews: '\u6700\u65b0\u5e02\u573a\u65b0\u95fb',
    analyzingData: '\u6b63\u5728\u5206\u6790\u5e02\u573a\u6570\u636e...',
    sentimentAnalysis: '\u60c5\u7eea\u5206\u6790',
    bullish: '\u770b\u591a',
    bearish: '\u770b\u7a7a',
    neutral: '\u4e2d\u6027',
    enterTicker: '\u8f93\u5165\u80a1\u7968\u4ee3\u7801',
    settings: '\u8bbe\u7f6e',
    language: '\u8bed\u8a00',
    theme: '\u4e3b\u9898',
  },
  ar: {
    appName: '\u0645\u0633\u062a\u0634\u0627\u0631 \u0627\u0644\u0623\u0633\u0647\u0645 \u0627\u0644\u0630\u0643\u064a',
    subtitle: 'S&P 500 \u0630\u0643\u0627\u0621 \u2022 \u0645\u062f\u0639\u0648\u0645 \u0628\u0640 LLaMA',
    chat: '\u0645\u062d\u0627\u062f\u062b\u0629',
    portfolio: '\u0645\u062d\u0641\u0638\u0629',
    screener: '\u0641\u0631\u0632',
    heatmap: '\u062e\u0631\u064a\u0637\u0629 \u062d\u0631\u0627\u0631\u064a\u0629',
    backtest: '\u0645\u062d\u0627\u0643\u0627\u0629',
    compare: '\u0645\u0642\u0627\u0631\u0646\u0629',
    watchlist: '\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0645\u0631\u0627\u0642\u0628\u0629',
    earnings: '\u0627\u0644\u0623\u0631\u0628\u0627\u062d',
    news: '\u0623\u062e\u0628\u0627\u0631',
    liveData: '\u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0628\u0627\u0634\u0631\u0629',
    model: '\u0627\u0644\u0646\u0645\u0648\u0630\u062c',
    askPlaceholder: '\u0627\u0633\u0623\u0644 \u0639\u0646 \u0627\u0644\u0623\u0633\u0647\u0645 \u0623\u0648 \u0627\u062a\u062c\u0627\u0647\u0627\u062a \u0627\u0644\u0633\u0648\u0642...',
    disclaimer: '\u0647\u0630\u0627 \u0644\u064a\u0633 \u0646\u0635\u064a\u062d\u0629 \u0645\u0627\u0644\u064a\u0629.',
    totalValue: '\u0627\u0644\u0642\u064a\u0645\u0629 \u0627\u0644\u0625\u062c\u0645\u0627\u0644\u064a\u0629',
    totalPnL: '\u0627\u0644\u0631\u0628\u062d/\u0627\u0644\u062e\u0633\u0627\u0631\u0629',
    holdings: '\u0627\u0644\u0645\u0645\u062a\u0644\u0643\u0627\u062a',
    addHolding: '\u0625\u0636\u0627\u0641\u0629 \u0645\u0644\u0643\u064a\u0629',
    symbol: '\u0627\u0644\u0631\u0645\u0632',
    shares: '\u0627\u0644\u0623\u0633\u0647\u0645',
    buyPrice: '\u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621',
    buyDate: '\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0634\u0631\u0627\u0621',
    add: '\u0625\u0636\u0627\u0641\u0629',
    remove: '\u062d\u0630\u0641',
    search: '\u0628\u062d\u062b',
    filter: '\u062a\u0635\u0641\u064a\u0629',
    sector: '\u0627\u0644\u0642\u0637\u0627\u0639',
    allSectors: '\u062c\u0645\u064a\u0639 \u0627\u0644\u0642\u0637\u0627\u0639\u0627\u062a',
    generateReport: '\u0625\u0646\u0634\u0627\u0621 \u062a\u0642\u0631\u064a\u0631',
    downloadPDF: '\u062a\u062d\u0645\u064a\u0644 PDF',
    investment: '\u0627\u0644\u0627\u0633\u062a\u062b\u0645\u0627\u0631',
    period: '\u0627\u0644\u0641\u062a\u0631\u0629',
    run: '\u062a\u0634\u063a\u064a\u0644',
    clear: '\u0645\u0633\u062d',
    marketOverview: '\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629 \u0639\u0644\u0649 \u0627\u0644\u0633\u0648\u0642',
    latestNews: '\u0622\u062e\u0631 \u0627\u0644\u0623\u062e\u0628\u0627\u0631',
    analyzingData: '\u062c\u0627\u0631\u064a \u062a\u062d\u0644\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0633\u0648\u0642...',
    sentimentAnalysis: '\u062a\u062d\u0644\u064a\u0644 \u0627\u0644\u0645\u0634\u0627\u0639\u0631',
    bullish: '\u0635\u0627\u0639\u062f',
    bearish: '\u0647\u0627\u0628\u0637',
    neutral: '\u0645\u062d\u0627\u064a\u062f',
    enterTicker: '\u0623\u062f\u062e\u0644 \u0631\u0645\u0632 \u0627\u0644\u0633\u0647\u0645',
    settings: '\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a',
    language: '\u0627\u0644\u0644\u063a\u0629',
    theme: '\u0627\u0644\u0645\u0638\u0647\u0631',
  },
};

const LANGUAGE_NAMES = { en: 'English', es: 'Espa\u00f1ol', zh: '\u4e2d\u6587', ar: '\u0627\u0644\u0639\u0631\u0628\u064a\u0629' };

const LanguageContext = createContext();

export function LanguageProvider({ children }) {
  const [lang, setLang] = useState(() => localStorage.getItem('lang') || 'en');

  useEffect(() => {
    localStorage.setItem('lang', lang);
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = lang;
  }, [lang]);

  const t = (key) => translations[lang]?.[key] || translations.en[key] || key;

  return (
    <LanguageContext.Provider value={{ lang, setLang, t, languages: LANGUAGE_NAMES }}>
      {children}
    </LanguageContext.Provider>
  );
}

export const useLanguage = () => useContext(LanguageContext);
